{% extends 'base.html' %}
{% load static %}


{% block content %}    

    
    <main>
    
    <div class="mb-4 pb-lg-3"></div>

    <section class="shop-main container d-flex">
      <div class="shop-sidebar side-sticky bg-body" id="shopFilter">
        <div class="aside-header d-flex d-lg-none align-items-center">
          <h3 class="text-uppercase fs-6 mb-0">Filter By</h3>
          <button class="btn-close-lg js-close-aside btn-close-aside ms-auto"></button>
        </div><!-- /.aside-header -->

        <div class="pt-4 pt-lg-0"></div>

        <div class="accordion" id="categories-list">
          <div class="accordion-item mb-4 pb-3">
            <h5 class="accordion-header" id="accordion-heading-1">
              <button class="accordion-button p-0 border-0 fs-5 text-uppercase" type="button" data-bs-toggle="collapse" data-bs-target="#accordion-filter-1" aria-expanded="true" aria-controls="accordion-filter-1">
                Категории
                <svg class="accordion-button__icon type2" viewBox="0 0 10 6" xmlns="http://www.w3.org/2000/svg">
                  <g aria-hidden="true" stroke="none" fill-rule="evenodd">
                    <path d="M5.35668 0.159286C5.16235 -0.053094 4.83769 -0.0530941 4.64287 0.159286L0.147611 5.05963C-0.0492049 5.27473 -0.049205 5.62357 0.147611 5.83813C0.344427 6.05323 0.664108 6.05323 0.860924 5.83813L5 1.32706L9.13858 5.83867C9.33589 6.05378 9.65507 6.05378 9.85239 5.83867C10.0492 5.62357 10.0492 5.27473 9.85239 5.06018L5.35668 0.159286Z"/>
                  </g>
                </svg>
              </button>
            </h5>
            <div id="accordion-filter-1" class="accordion-collapse collapse show border-0" aria-labelledby="accordion-heading-1" data-bs-parent="#categories-list">
              <div class="accordion-body px-0 pb-0 pt-3">
                <ul class="list list-inline mb-0">
                  {% for category in catrgories %}  
                  <li class="list-item">
                    <a href="{% url 'products:category' category.id %}" class="menu-link py-1">{{ category.name }}</a>
                  </li>
                  {% endfor %}
                </ul>
              </div>
            </div>
          </div><!-- /.accordion-item -->
        </div><!-- /.accordion-item -->


        
      </div><!-- /.shop-sidebar -->

      <div class="shop-list flex-grow-1">
        <div class="cart-table__wrapper">
        <table class="cart-table">
          <thead>
            <tr>
              <th>Наименование</th>
              <th></th>
              <th>Цена</th>
              <th>Количество</th>
              <th>Итого</th>
              <th></th>
            </tr>
          </thead>
          <tbody>

            {% for product in products  %}
            
            <tr>
              
              <td>
                <div class="shopping-cart__product-item">
                  <a href="{% url 'products:product_detail' product.id %}">
                  <img loading="lazy" src="{{ product.images.all.0.image.url }}"  width="50" height="50" alt="" />
                  </a> 
                </div>
              </td>
              <td>
                <div class="shopping-cart__product-item__detail">
                  <h4>{{ product }}</h4>
                  
                </div>
              </td>
              <td>
                <span class="shopping-cart__product-price">$ Цена без скидки: $${{ product.price_with_markup_and_vat }}
                  {% if product.is_promotion_active %}
                      Цена со скидкой: ${{ product.promotion.discount_percentage }}
                  {% else %}
                      
                  {% endif %}</span>
              </td>
              
            </tr>
                
            {% endfor %}

          </tbody>
        </table>
      </div>

        
        
        <nav class="shop-pages d-flex justify-content-between mt-3" aria-label="Page navigation">
          <a href="{% if products.has_previous %}{% url 'products:paginator' products.previous_page_number %}{% else %}#{% endif %}" class="btn-link d-inline-flex align-items-center">
            <svg class="me-1" width="7" height="11" viewBox="0 0 7 11" xmlns="http://www.w3.org/2000/svg"><use href="#icon_prev_sm" /></svg>
            <span class="fw-medium" {% if not products.has_previos %} disabled {% endif %}>Предыдущая</span>
          </a>
          <ul class="pagination mb-0">
            {% for page in products.paginator.page_range %}              
            <li class="page-item"><a class="btn-link px-1 mx-2" href="{% url 'products:paginator' page %}">{{ page }}</a></li>
            {% endfor %}  
{#            <li class="page-item"><a class="btn-link px-1 mx-2 btn-link_active" href="#">1</a></li>#}
           
          </ul>
          <a href="{% if products.has_next %}{% url 'products:paginator' products.next_page_number %}{% else %}#{% endif %}" class="btn-link d-inline-flex align-items-center">
            <span class="fw-medium me-1" {% if not products.has_next %} disabled {% endif %}>Следующая</span>
            <svg width="7" height="11" viewBox="0 0 7 11" xmlns="http://www.w3.org/2000/svg"><use href="#icon_next_sm" /></svg>
          </a>
        </nav>
      </div>
    </section><!-- /.shop-main container -->
    
    <div class="mb-4 pb-lg-3"></div>
  </main>
    
   
    
{% endblock %}
  
